OOP
===
# Порождающие паттерны проектирования
## Фабрика
### Общеие принципы
Мы выдаем ответственность за создание объектов в отдельный фабричный метод, а все объекты должны реализовывать один интерфейс.  Подклассы реализуют логику фабричного метода как им вздумается.  Созданые методом объекты сами реализуют логику своего интерфейса, но пользовательскому коду все равно. 

### Паттерн состоит из
- Продукт определяет общий интерфейс объектов, которые может произвести метод подкласса.  - Конкретные продукты содержат код реализации, но интерфейс общий
- Создатель определяет фабричный метод, который возвращает новые
- объекты продуктов

![qownnotes-media-JbEKjh](media/qownnotes-media-JbEKjh.png)
### Код
``` C#
interface IDeliver
{
    public void DoDelivery();
}

abstract class Logistics
{
    public abstract IDeliver CreateTransport();

    public void PlanDelivery()
    {
        IDeliver transport = CreateTransport();
        transport.DoDelivery();
    }
}

class RoadLogistics : Logistics
{
    public override IDeliver CreateTransport()
    {
        return new Truck();
    }
    
}

class SeaLogistics : Logistics
{
    public override IDeliver CreateTransport()
    {
        return new Ship();
    }
}

class Truck : IDeliver
{
    public void DoDelivery()
    {
        Console.WriteLine("I am Trucking");
    }
}

class Ship : IDeliver
{
    public void DoDelivery()
    {
        Console.WriteLine("I am Shipping");
    }
}

internal class Program
{
    public static void Main(string[] args)
    {
        Logistics[] arr = {new RoadLogistics(), new SeaLogistics()};
        foreach (Logistics shipment in arr)
        {
            shipment.PlanDelivery();
        }
    }
}
```
### Реализация
- Привести все продукты к общему интерфейсу
- В классе-фабрике создать пустой фабричный метод,  возвращающий интерфейс
- В коде наследнике фабрики замените все учатки, создающие продукты, на вызов фабричного метода
- Для каждого типа продуктов завести свой подклас и переопределить в нем фабричный метод
- Сделать фабричный метод абстрактным
### Плюсы
+ Избавляет класс от привязки к конкретным классам продуктов
+ Выделяет код производства в одно место
+ Упрощает расширение программы на новые продукты
+ Реализует принцип open/close
### Минусы
- может привести к созданию больших параллельных иерархий классов, так как для каждого класса продукта нужен свой класс создателя
________
## Абстрактная фабрика
### Общие принципы
Это порождающий паттерн проектирования, который позволяет создать семейства свзанных объектов,  не привязываясь к конкретным классам создаваемых объектов.  
Суть заключается в создании общего интерфейса для фабрик, через который взаимодействует клиент.  Данный интерфейс может создать семейство продуктов. У всех абстрактных продуктов есть свои интерфейсы, а конкретные реализации расширяют их

![qownnotes-media-jVaBme](media/qownnotes-media-jVaBme.png)

### Паттерн состоит из
1. Абстрактного продукта 
    - Объявляют интиерфейс продуктов, которые связаны друг с другом по смыслу, но выполняют разные функции
1.  Конкретные продукты 
    - Большой набор классов, котоыре относятся к различным абстрактным продуктам, но имеют одинаковые вариации
1.  Абстрактная фабрика
    - Объявляет методы создания различных продуктов
1.  Конкретные фабрики
    - Относятся каждая к своей вариации продуктов

Итого, пользователь обращается к требуемуй конкретной фабрике через абстрактный интерфейс и общается с получеными продуктами через их интерфейсы. Реализация продукта зависит от типа фабрики.  
### Реализация
1. Создать таблицу отношений продуктов к вариациям семейств продуктов

![qownnotes-media-qLTdsA](media/qownnotes-media-qLTdsA.png)

2. Сведите все вариации продуктов к общим интерфейсам  

3. Опрелелить интерфейс абстрактной фабрики. Он должен иметь методы для создания всех продуктов
4. Создать классы фабрик,  реализовав интерфейс абстрактной фабрики. Количество классов == количеству семейств продуктов

5. Добавить в иннициализатор программы код для выбора фабрики. Оно должно передавать фабрику в клиентский код
### Плюсы
+ гарантирует сочетаемость продуктов
+ Избавляет клиентский код от привязки к конкретным классам
+ Выделяет код производства продуктов в одно место
+ Упрощает добавление новых продуктов
+ Поддерживает принцип open/close
### Минусы
- Усложняет код множеством дополнительных классов
- Требует существования всех типов продукции в каждой вариации
___
## Строитель
Порождающий паттерн проектирования, который позволяет создавать сложные объекты пошагово. Строитель даёт возможность использовать один и тот же код строительства для получения разных представлений объектов.  
![qownnotes-media-mhvJXL](media/qownnotes-media-mhvJXL.png)
### Общие принципы
Паттерн состоит из иерархии Директор -> Интерфейс Строитель -> Строитель объекта. Директор имеет интерфейс с паттернами и вызывает нужные методы у строителя. У строителя есть метод возврата объекта, который он сконфигурировал после всех команд.
### Паттерн состоит из
1. Директор
    - Имеет в себе шаблоны указаний конструктору для требуемых манипуляций
    - Не передает сконструированный объект клиенту
    - Принимает от клиента конструктора, которым он будет управлять. Он этого зависит выходной объект
2. Строитель
    - У всех конструкторов общий интерфейс
    - Разные конструкторы могут возвращать разные инициализированные объекты
    - Ответственен за возврат клиенту объекта, так как директор не знает про тип возврата строителя

1. Интерфейс строителя объявляет шаги конструирования продуктов, общие для всех  видов строителей
2. Конкретные строители реализуют строительные шаги, каж- дый по-своему. Конкретные строители могут производить разнородные объекты, не имеющие общего интерфейса.
3. Продукт - создаваемый объект. Продукты, сделанные раз- ными строителями, не обязаны иметь общий интерфейс.
4. Директор определяет порядок вызова строительных шагов для производства той или иной конфигурации продуктов.

### Реализация
1. Определить, может ли процесс создания разных классов свестись к одинаковым шагам
2. Описать шаги в интерфейсе строителей
3. Для каждого из продуктов создать по классу-строителю  
    (Метод возврата продукта не обязательно прописан в интерфейсе, так как зависит от объекта, который реализует строитель)
4. Рассмотреть потребность в классе директора
5. Клиент передает строителя директору
### Плюсы
- Позволяет создавать продукты пошагово
- Позволяет использовать одинаковый код для создания различных продуктов
- Изолирует сложный код сборки продукта от основной логики
### Минусы
- Усложняет код программы введением новых классов
- Клиент будет привязан к конкретным классам строителей, так как директор не возвращает результат
___
## Прототип

Прототип — это порождающий паттерн проектирования, который позволяет копировать объекты, не вдаваясь в подробности их реализации.


